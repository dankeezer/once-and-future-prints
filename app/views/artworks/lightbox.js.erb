
var paddingWidth = ($(window).width() - $("#<%= @artwork.position %>").width()) / 2
var paddingHeight = ($(window).height() - $("#<%= @artwork.position %>").height()) / 2

var $overlay = $('.overlay');
var scrollLeft = $overlay.scrollLeft() + $('#<%= @artwork.position %>').offset().left


if ($("#<%= @artwork.position %>").css("z-index") == "0") {

  $('#lightbox').stop().animate({opacity:"0"}, 500, function(){
    $('.overlay').css("overflow-x", "scroll");
    $('.overlay').css("-webkit-overflow-scrolling", "touch");
    $('#lightbox').css("z-index","-5");
    $("#<%= @artwork.position %>").css("z-index","-4");
    $("#<%= @artwork.position %>").css("position","inherit");
  });

  // $('.overlay').animate({"top":"0"}, 500);
  $('#status').stop().animate({opacity:"1"}, 500);

  var captionHide =  String(((parseInt($("#caption").css("height")) + 10) * -1) + "px")
  $('#caption').stop().animate({bottom:captionHide}, 500);
  $('#topMask').stop().animate({top:"-3"}, 500);

  $("#<%= @artwork.position %>").stop().animate({
    top: "0px",
    paddingLeft:"0px",
    paddingRight:"0px"
  }, 500);

  $('.overlay').stop().animate({
    scrollLeft : $overlay.scrollLeft() - paddingWidth
  }, 500)
  event.preventDefault();



  // $(document).ajaxComplete(function(e, xhr, settings){
  //   $("img").photoResize({
  //     bottomSpacing:"18"
  //   });
  // });
  // $('img').css("height","inherit");

} else {


  $('#inner').html("<b><%= @artwork.name %></b> <%= @artwork.description %>");

  var captionWidth = $("#<%= @artwork.position %>").css("width")
  $('#caption').css("width", captionWidth )
  $('#caption').css("margin-left", paddingWidth)


  // var imgHeight = parseInt($('img').css("height")) + 18

  // var paddingWidth = ($(window).width() - $("#<%= @artwork.position %>").width()) / 2
  $('.overlay').stop().animate({
    scrollLeft: scrollLeft
  }, 500)
  event.preventDefault();

  $('#status').animate({opacity:"0"}, 500);
  $('#caption').stop().animate({opacity:"1"}, 500);

  // var paddingWidth = ($(window).width() - $("#<%= @artwork.position %>").width()) / 2


  $("#<%= @artwork.position %>").css("z-index","0");
  $("#<%= @artwork.position %>").css("-webkit-transform", "translate3d(0,0,100)");
  $("#<%= @artwork.position %>").css("position","relative");
  $("#<%= @artwork.position %>").stop().animate({
    paddingLeft:paddingWidth,
    paddingRight:paddingWidth
  }, 500, function(){
    $('#caption').stop().animate({bottom:"0"}, 500);
    $('#topMask').stop().animate({top:"0"}, 500);
    $("#<%= @artwork.position %>").stop().animate({top: "-5px"}, 500);
    $('#topMask').css("opacity","1")
  });

  $('.overlay').css("overflow-x", "hidden");
  $('.overlay').css("-webkit-overflow-scrolling", "hidden");


  $('#lightbox').css("z-index","-3");
  $('#lightbox').stop().animate({opacity:".5"}, 500);


}